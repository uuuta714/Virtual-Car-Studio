<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<html lang="en" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Virtual Car Studio</title>
    <link rel="stylesheet" href="scss/styles.scss">
    <link rel="stylesheet" href="scss/styles.scss">
</head>
<body>
    <!-- WIP From -->
    <nav class="navbar bg-body-tertiary fixed-top">
        <div class="container-fluid">
          <a class="navbar-brand" href="#">Virtual Car Studio</a>
          <button class="navbar-toggler" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasNavbar" aria-controls="offcanvasNavbar" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <!-- Offcanvas -->
          <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasNavbar" aria-labelledby="offcanvasNavbarLabel">
            <!-- Header -->
            <div class="offcanvas-header">
              <h5 class="offcanvas-title" id="offcanvasNavbarLabel">Menu</h5>
              <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
            </div>
            <!-- Body -->
            <div class="offcanvas-body">
                <!-- Tabs -->
                <ul class="nav nav-tabs" id="myTab" role="tablist">
                    <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="env-tab" data-bs-toggle="tab" data-bs-target="#env-tab-pane" type="button" role="tab" aria-controls="env-tab-pane" aria-selected="true">Environment</button>
                    </li>
                    <li class="nav-item" role="presentation">
                    <button class="nav-link" id="lighting-tab" data-bs-toggle="tab" data-bs-target="#lighting-tab-pane" type="button" role="tab" aria-controls="lighting-tab-pane" aria-selected="true">Lighting</button>
                    </li>
                    <li class="nav-item" role="presentation">
                    <button class="nav-link" id="camera-tab" data-bs-toggle="tab" data-bs-target="#camera-tab-pane" type="button" role="tab" aria-controls="camera-tab-pane" aria-selected="false">Camera</button>
                    </li>
                    <li class="nav-item" role="presentation">
                    <button class="nav-link" id="video-export-tab" data-bs-toggle="tab" data-bs-target="#video-export-tab-pane" type="button" role="tab" aria-controls="video-export-tab-pane" aria-selected="false">Video Export</button>
                    </li>
                </ul>
                <div class="tab-content" id="myTabContent">
                    <!-- Environment -->
                    <div class="tab-pane fade show active" id="env-tab-pane" role="tabpanel" aria-labelledby="env-tab" tabindex="0">
                        <div id="env-content">
                            <p class="fs-4 my-4">Choose Environment</p>
                            <button id="snow" class="btn btn-secondary btn-lg">Snow</button>
                            <button id="beach" class="btn btn-secondary btn-lg">Beach</button>
                            <button id="studioButton" class="btn btn-secondary btn-lg">Studio</button>
                            <div class="tab-pane fade" id="studio" role="tabpanel" aria-labelledby="studio-tab">
                                <div class="d-grid gap-2">
                                    <p class="fs-4 my-4">Set Up Studio Environment</p>
                                    <button id="defaultLight" class="btn btn-secondary">Default studio lighting</button>
                                    <button id="customLight" class="btn btn-secondary">Customise studio lighting</button>
                                    <p class="fs-4 my-4">Select Floor Material</p>
                                    <select class="form-select" id="floorDropdown">
                                        <option value="asphalt">Asphalt</option>
                                        <option value="concrete">Concrete</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Lighting -->
                    <div class="tab-pane fade" id="lighting-tab-pane" role="tabpanel" aria-labelledby="lighting-tab" tabindex="0">
                        <div id="lighting-content">
                            <p class="fs-4 my-4">Set Up Lighting Environment</p>
                            <ul class="list-unstyled my-4">
                                <li class="fw-normal"><em>Instructions</em></li>
                                <li class="fw-normal"><em>- Use mouse or arrow keys to move light instance</em></li>
                                <li class="fw-normal"><em>- Select light instance from the dropdown menu to manipulate its property</em></li>
                                <!-- <li class="fw-normal"><em>- 'L' Key: Rotate selected object anti-clockwise</em></li> -->
                            </ul>
                            <p class="fs-5 my-3">Select Light Instance</p>
                            <div class="row">
                                <div class="col">
                                    <select class="form-select" id="lightInstanceDropdown">
                                        <option value="">Select a Light Instance</option>
                                    </select>
                                </div>
                            </div>
                            <p class="fs-5 my-3">Clone / Remove Light Instance</p>
                            <div class="d-grid gap-2">
                                <button id="addLightButton" class="btn btn-secondary">Clone</button>
                                <button id = "deleteLightButton" class="btn btn-danger">Remove</button>
                            </div> 
                            <br>
                            <p class="fs-5 my-3">Select Lighting Intensity</p>
                            <div class="row">
                                <div class="col">
                                    <input type="number" class="form-control" id="intensityInput" min="0" step="0.01">
                                </div>
                                <div class="col">
                                    <button id="applyIntensityButton" class="btn btn-secondary">Apply</button>
                                </div>
                            </div>
                            <br>                
                            <p class="fs-5 my-3">Select Lighting Colour</p>
                            <div class="row">
                                <div class="col">
                                    <input type="color" class="form-control form-control-color" id="colorPicker" value="#ffffff">
                                </div>
                                <div class="col">
                                    <button id="applyColorButton" class="btn btn-secondary">Apply</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Camera -->
                    <div class="tab-pane fade" id="camera-tab-pane" role="tabpanel" aria-labelledby="camera-tab" tabindex="0">
                        <div id="camera-content">
                            <p class="fs-4 my-4">Create Camera Movement</p>
                            <ul class="list-unstyled my-4">
                                <li class="fw-normal"><em>Instructions</em></p>
                                <li class="fw-normal"><em>- 'R' Key: Rotation control of custom camera</em></li>
                                <li class="fw-normal"><em>- 'T' Key: Translation control of custom camera</em></li>
                            </ul>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" role="switch" id="custom-camera-visibility">
                                <label class="form-check-label" for="flexSwitchCheckDefault">Display custom camera</label>
                            </div>
                            <p class="fs-5 my-3">Enter Name and Duration</p>
                            <div class="row align-items-center">
                                <div class="col">
                                    <label for="cameraMovementName">Name:</label>
                                </div>
                                <div class="col">
                                    <input type="text" class="form-control" id="cameraMovementName" name="cameraMovementName">
                                </div>
                            </div>
                            <div class="row align-items-center">
                                <div class="col">
                                    <label for="duration">Duration (Seconds):</label>
                                </div>
                                <div class="col">
                                    <input type="number" class="form-control" id="duration" name="duration" min="1" max="10" step="0.1">
                                </div>
                            </div>
                            <br>
                            <p class="fs-5 my-3">Select Easing Effect and Type</p>
                            <div class="row align-items-center">
                                <div class="col">
                                    <label for="easingEffectName">Easing Effect:</label>
                                </div>
                                <div class="col">
                                    <select class="form-select" id="easingEffectDropdown">
                                        <option value="none">none</option>
                                        <option value="power2">power</option>
                                        <option value="back">back</option>
                                        <option value="circ">circ</option>
                                        <option value="elastic">elastic</option>
                                        <option value="expo">expo</option>
                                    </select>
                                </div>
                            </div>
                            <div class="row align-items-center">
                                <div class="col">
                                    <label for="easingTypeName">Easing Type:</label>
                                </div>
                                <div class="col">
                                    <select class="form-select" id="easingTypeDropdown" disabled>
                                        <option value="in">in</option>
                                        <option value="inOut">inOut</option>
                                        <option value="out">out</option>
                                    </select>
                                </div>
                            </div>
                            <br>
                            <div class="row align-items-center">
                                <a class="link-body-emphasis" href="https://gsap.com/docs/v3/Eases/">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-file-earmark-text-fill" viewBox="0 0 16 16">
                                        <path d="M9.293 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V4.707A1 1 0 0 0 13.707 4L10 .293A1 1 0 0 0 9.293 0M9.5 3.5v-2l3 3h-2a1 1 0 0 1-1-1M4.5 9a.5.5 0 0 1 0-1h7a.5.5 0 0 1 0 1zM4 10.5a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5m.5 2.5a.5.5 0 0 1 0-1h4a.5.5 0 0 1 0 1z"/>
                                    </svg>
                                    Understand about Easing Effect
                                </a>
                            </div>
                            <br>
                            <p class="fs-5 my-3">Set Start Position</p>
                            <div class="d-grid gap-2">
                                <button id="setStartPositionFromMainCamera" class="btn btn-light">Capture Browser View Position</button>
                                <button id="setStartPositionFromCustomCamera" class="btn btn-secondary">Capture Custom Camera Position</button>
                            </div>
                            <div class="row mt-3">
                                <div class="col">
                                    <p class="fs-6 my-2">Camera Start Position</p>
                                    <input type="number" class="form-control form-control-sm" id="cameraStartPositionX" placeholder="X" name="cameraStartPositionX">
                                    <input type="number" class="form-control form-control-sm" id="cameraStartPositionY" placeholder="Y" name="cameraStartPositionY">
                                    <input type="number" class="form-control form-control-sm" id="cameraStartPositionZ" placeholder="Z" name="cameraStartPositionZ">
                                </div>
                                <div class="col">
                                    <p class="fs-6 my-2">Camera Start Direction</p>
                                    <input type="number" class="form-control form-control-sm" id="cameraStartLookAtPositionX" placeholder="X" name="cameraStartLookAtPositionX">
                                    <input type="number" class="form-control form-control-sm" id="cameraStartLookAtPositionY" placeholder="Y" name="cameraStartLookAtPositionY">
                                    <input type="number" class="form-control form-control-sm" id="cameraStartLookAtPositionZ" placeholder="Z" name="cameraStartLookAtPositionZ">
                                </div>
                            </div>
                            <br>
                            <p class="fs-5 my-3">Set End Position</p>
                            <div class="d-grid gap-2">
                                <button id="setEndPositionFromMainCamera" class="btn btn-light">Capture Browser View Position</button>
                                <button id="setEndPositionFromCustomCamera" class="btn btn-secondary">Capture Custom Camera Position</button>
                            </div>
                            <div class="row mt-3">
                                <div class="col">
                                    <p class="fs-6 my-2">Camera End Position</p>
                                    <input type="number" class="form-control form-control-sm" id="cameraEndPositionX" placeholder="X" name="cameraEndPositionX">
                                    <input type="number" class="form-control form-control-sm" id="cameraEndPositionY" placeholder="Y" name="cameraEndPositionY">
                                    <input type="number" class="form-control form-control-sm" id="cameraEndPositionZ" placeholder="Z" name="cameraEndPositionZ">
                                </div>
                                <div class="col">
                                    <p class="fs-6 my-2">Camera End Direction</p>
                                    <input type="number" class="form-control form-control-sm" id="cameraEndLookAtPositionX" placeholder="X" name="cameraEndLookAtPositionX">
                                    <input type="number" class="form-control form-control-sm" id="cameraEndLookAtPositionY" placeholder="Y" name="cameraEndLookAtPositionY">
                                    <input type="number" class="form-control form-control-sm" id="cameraEndLookAtPositionZ" placeholder="Z" name="cameraEndLookAtPositionZ">
                                </div>
                            </div>
                            <div class="d-grid my-3">
                                <button id="createCameraMovement" class="btn btn-danger">Create Movement</button>
                            </div>
                        </div>
                    </div>
                    <!-- Video Export -->
                    <div class="tab-pane fade" id="video-export-tab-pane" role="tabpanel" aria-labelledby="video-export-tab" tabindex="0">
                        <div id="video-export-content">
                            <p class="fs-4 my-4">Create Custom Video</p>
                            <p class="fs-5 my-3">Select Camera Sequence</p>
                            <div class="row">
                                <div class="col-auto">
                                    <select class="form-select" id="cameraSequenceDropdown">
                                        <option value="">Select a Camera Movement</option>
                                    </select>
                                </div>
                                <div class="col-auto">
                                    <button id="addToSequenceButton" class="btn btn-secondary">Add</button>
                                </div>
                            </div>
                            <ol class="list-group list-group-numbered my-3" id="selectedSequenceList">
                                <p class="fw-normal m-0">No camera movement is added in the sequence</p>
                            </ol>
                            <div class="d-grid gap-2">
                                <button id="resetSequenceButton" class="btn btn-danger">Reset Sequence</button>
                            </div>
                            <br>
                            <p class="fs-5 my-3">Preview / Export Video</p>
                            <div class="d-grid gap-2">
                                <button id="start-preview" class="btn btn-secondary">Preview</button>
                                <button id="start-recording" class="btn btn-danger">Record</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
          </div>
        </div>
    </nav>
    <!-- WIP To -->
    <div id="progress-container" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: rgba(255, 255, 255, 0.8); padding: 10px; border-radius: 5px; color: black">
        <div id="progress">Loading 3D model...</div>
      </div>
    
    <script src="./js/scripts.js" type="module"></script>
    <script src="./js/lighting.js" type="module"></script>
    <script src="./js/userInteractions.js" type="module"></script>
    <script src="./js/env.js" type="module"></script>
    <script src="/node_modules/webm-writer/WebMWriter.js"></script>
</body>
</html>